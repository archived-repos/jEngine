function stopEvent(e){if(e)e.stopped=true;if(e&&e.preventDefault)e.preventDefault();else if(window.event&&window.event.returnValue)window.eventReturnValue=false}function triggerEvent(e,t,n,r){var i;if(document.createEvent){i=document.createEvent("HTMLEvents");i.data=r;i.initEvent(t,true,true)}else{i=document.createEventObject();i.data=r}i.eventName=t;if(isObject(n)){Object.keys(n).forEach(function(e){i[e]=n[e]})}if(document.createEvent){e.dispatchEvent(i)}else{e.fireEvent("on"+i.eventType,i)}return i}function varType(e){if(e===undefined||e===null)return"undefined";if(typeof e=="object"){if(e.jquery)return"jquery";var t=(""+e.constructor).match(/^\s*function\s*(.*)\(/);if(t)return t[1].toLowerCase();t=(""+e.constructor).match(/^\[object\s(.*)\]$/);if(t)return t[1].toLowerCase();alert("unknown object "+e.constructor)}else return typeof e}function isObject(e,t){if(e instanceof Object)return t=="any"?true:varType(e)==(t||"object");else return false}function isString(e){return varType(e)=="string"}function isFunction(e){return e instanceof Function}function isArray(e){return e instanceof Array}function isNumber(e){return varType(e)=="number"}function compareDates(e,t){if(isString(e)&&isString(t)){var e=e.toDate();var t=t.toDate();if(e&&t){if(e-t==0)return 0;else if(e>t)return 1;else if(e<t)return-1}}return false}function listField(e,t){var n=[];var r;e.forEach(function(e){if(e[t])n.push(e[t])});return n}function serializeKeys(e,t){var n=false;for(key in e){if(e[key].forEach){e[key].forEach(function(e){if(n)n+="&";else n="";if(t)n+=key+"="+encodeURIComponent(e);else n+=key+"="+e})}else{if(n)n+="&";else n="";n+=t?key+"="+encodeURIComponent(e[key]):key+"="+e[key]}}return n}window.benchmark=function(e,t){t=t||1e5;if(e instanceof Function){var n=(new Date).getTime();for(var r=0;r<t;r++)e();var i=(new Date).getTime();return i-n}return false};window.log=function(){log.history=log.history||[];log.history.push(arguments);if(this.console){console.log(Array.prototype.slice.call(arguments))}};(function(){function e(e,t){if(!t)t={};var n={done:[],fail:[],always:[]};if(isFunction(t.done))n.done.push(t.done);if(isFunction(t.fail))n.fail.push(t.fail);if(isFunction(t.always))n.always.push(t.always);if(!t.method)t.method="GET";if(!t.contentType){if(/^json$/i.test(t.mode))t.contentType="application/json";else t.contentType="application/x-www-form-urlencoded"}if(/^json$/i.test(t.mode)&&isObject(t.data))t.data=JSON.stringify(t.data);var r=null;try{r=new XMLHttpRequest}catch(i){try{r=new ActiveXObject("Msxml2.XMLHTTP")}catch(i){r=new ActiveXObject("Microsoft.XMLHTTP")}}if(r===null){alert("Browser does not support HTTP Request")}r.open(t.method,e,t.async===undefined?true:t.async);r.onreadystatechange=function(){if(r.readyState=="complete"||r.readyState==4){if(r.status==200){var e=/^json$/i.test(t.mode)?JSON.parse(r.responseText):/^xml$/i.test(t.mode)?r.responseXML:r.responseText;n.done.forEach(function(t){t.apply(r,[e])})}else{var e=/^json$/i.test(t.mode)?JSON.parse(r.responseText):/^xml$/i.test(t.mode)?r.responseXML:r.responseText;n.fail.forEach(function(t){t.apply(r,[e])})}n.always.forEach(function(e){e.apply(r,[r])})}};r.done=function(e){if(isFunction(e))n.done.push(e);return r};r.fail=function(e){if(isFunction(e))n.fail.push(e);return r};r.always=function(e){if(isFunction(e))n.always.push(e);return r};r.setRequestHeader("Content-Type",t.contentType);r.setRequestHeader("X-Requested-With","XMLHttpRequest");if(isObject(t.headers)){Object.keys(t.headers).forEach(function(e){r.setRequestHeader(e,t.headers[e])})}r.send(t.data);return r}window.$ajax=function(){return e.apply(this,arguments)};window.$ajax.getJSON=function(t,n){n=n||{};n.mode=n.mode||"json";n.method="GET";return e.apply(e,[t,n])};window.$ajax.postJSON=function(t,n){n=n||{};n.mode=n.mode||"json";n.method="POST";return e.apply(e,[t,n])};window.$ajax.putJSON=function(t,n){n=n||{};n.mode=n.mode||"json";n.method="PUT";return e.apply(e,[t,n])};window.$ajax.deleteJSON=function(t,n){n=n||{};n.mode=n.mode||"json";n.method="DELETE";return e.apply(e,[t,n])}})();Event=Event||window.Event;if(!Array.prototype.clone){Array.prototype.clone=function(){var e=[];Array.prototype.push.apply(e,this);return e}}if(!Array.prototype.sortBy){Array.prototype.sortBy=function(){if(arguments.length){var e=arguments;if(isArray(arguments[0]))e=arguments[0];this.sort(function(t,n){var r=0;while(key=e[r++]){if(Object.key(t,key)<Object.key(n,key))return-1;if(Object.key(t,key)>Object.key(n,key))return 1}if(t<n)return-1;if(t>n)return 1;return 0})}return this}}if(!Object.clone){Object.clone=function(e){var t={};if(e===undefined)return e;if(isArray(e))return e.clone();if(e.cloneNode)return e.cloneNode();for(var n in e)t[n]=isFunction((e[n]||{}).clone)?e[n].clone():e[n];return t}}if(!Object.key){Object.key=function(e,t,n){if(!e)return false;var r=t.split("."),i=e;if(n){if(r.length){var s=r.shift(),o;while(o=r.shift()){if(!e[s])e[s]={};e=e[s];s=o}e[s]=n}return n}else{for(var u=0,a=r.length;u<a;u++){if(i[r[u]]===undefined)return false;i=i[r[u]]||{}}return i}}}(function(){function e(e){var t=e.split(n),i=[t.shift()];e.replace(r,function(e,n,r){i.push({cmd:n,arg:r});i.push(t.shift())});return s("root",false,i)}function i(e,t,n,r){this.cmd=e;this.arg=t;this._=n||{};this.list=r||[]}function s(e,t,n){e=(e||"").trim();t=(t||"").trim();var r={content:[]},o="content",u=[r.content],a=function(e){r[e]=[];o=e;u.push(r[e])};token=n.shift();while(token!==undefined){if(isString(token))r[o].push(token);else if(token instanceof Object){if(token.cmd){switch(token.cmd){case"case":case"when":a(token.arg);break;default:if(t.substr(-1)=="/")r[o].push(new i(token.cmd,token.arg));else r[o].push(s(token.cmd,token.arg,n));break}}else switch(token.arg){case"else":a("alt");break;case"otherwise":a(token.arg);break;case"/":return new i(e,t,r,u);break;default:r[o].push(new i("var",token.arg));break}}token=n.shift()}if(e!="root")console.log("something wrong in script");return new i(e,t,r,u)}e.cmd=function(e,n){if(isString(e)&&isFunction(n))t[e]=n};var t={},n=/\$\w*{[\!\/\w\s\_\-\.]+}/,r=/\$(\w*){([\!\/\w\s\_\-\.]+)}/g;e._run=function(t,n){var r="";t.forEach(function(t){if(isString(t))r+=t;else if(isObject(t,"modelscript"))r+=t.render(n);else if(isArray(t))r+=e._run(t,n)});return r};e.modelQuery=function(e,t){var n=t.split("/"),r,i;while(r=n.shift()){if(r!="."){if(r=="..")e=e._parent||{};else{i=e;e=Object.key(e,r);e._parent=i}}}return e};e.modelEach=function(e,t){function n(n){if(isString(n)){n=[n];n._parent=e._parent}else n._parent=e;t(n)}if(isFunction(t)){if(isArray(e)){e.forEach(n)}else if(isObject(e)){Object.keys(e).forEach(function(t){n(e[t])})}}return e};t.root=function(e,t,n){return n};t.var=function(t,n,r){return e.modelQuery(t,n)};t.if=function(t,n,r,i){if(n.substr(0,1)=="!"){n=n.substr(1).trim();return e.modelQuery(t,n||"")?i:r}return e.modelQuery(t,n||"")?r:i};i.prototype.render=function(n){var r;if(t[this.cmd]instanceof Function){var i=[n||{}];i.push(this.arg);[].push.apply(i,this.list);r=t[this.cmd].apply(this,i)}else return"[command "+this.cmd+" not found]";if(isArray(r))return e._run(r,n);else if(isString(r))return r;return""};window.$script=e})();$script.cmd("each",function(e,t,n){var r="",i=false;if(/^[\w\_\-]+$/.test(t)){i=$script.modelQuery(e,t);$script.modelEach(i,function(e){r+=$script._run(n,e)})}return r});$script.cmd("for",function(e,t,n){function s(t,s){i=$script.modelQuery(e,t);if(isArray(i)){i.forEach(function(t){var i={_parent:e};if(s)i[s]=t;else i=t;r+=$script._run(n,i)})}else if(i instanceof Object){Object.keys(i).forEach(function(t){var i={_parent:e};if(s)i[s]=item;else i=item;r+=$script._run(n,i)})}}var r="",i=false;if(/^\s*[\w\.\_\-]+\s+in\s+[\w\.\_\-]+\s*$/.test(t)){var o=t.match(/^\s*([\w\.\_\-]+)\s+in\s+([\w\.\_\-]+)\s*$/);s(o[2],o[1])}return r});window.tmpl_script=$script("some text $if{hola}text if true${else}text if false${/}, some text $if{!hola}text if true${else}text if false${/} $each{tasks}[tarea: ${.}, ${../hola.caracola}]${/} ${hola.caracola}");if(!String.prototype.render){String.prototype.render=function(e){return $script(this).render(e)}}if(!String.prototype.replaceKeys){String.prototype.replaceKeys=function(e,t){var n,r;if(!t)t={};if(!e)return this;var i=this.replace(/\$\{\s*(.*)\s*\?\s*(.+)\s*\:\s*(.+)\s*\}/,function(t,n,r,i){var s=Object.key(e,n);if(isFunction(s)){if(s.apply(e))return"${"+r+"}";else return"${"+i+"}"}else{return"${"+(s?r:i)+"}"}});return i.replace(/\${\s*([\w\-\_\.\']+)\s*}/g,function(i,s){r=s.trim().match(/^\'(.*)\'$/);if(r&&r[1]!==undefined){return r[1]}else if(/\./.test(s)){n=Object.key(e,s);if(isFunction(n))return n.apply(e);else return n===false?t.clean?"":i:n}else{n=e[s];if(isFunction(n))return n.apply(e);else return n===undefined?t.clean?"":i:n}})}}if(!String.prototype.clearKeys){String.prototype.clearKeys=function(){return this.replace(/\${\s*([\w\-\_\.]+)\s*}/g,function(e,t){return""})}}if(!String.prototype.is){String.prototype.is=function(e){return this==e}}if(!String.prototype.serialized2JSON){String.prototype.serialized2JSON=function(e){var t,n=this.split("&");var r={};n.forEach(function(n){t=n.split("=");if(e)r[t[0]]=decodeURIComponent(t[1]);else r[t[0]]=t[1]});return r}}if(!String.prototype.capitalize){String.prototype.capitalize=function(e){if(e){var t=this.toLowerCase().split(" ");var n=false;t.forEach(function(e){if(n)n+=" "+e.capitalize();else n=e.capitalize()});return n}else return this.charAt(0).toUpperCase()+this.slice(1).toLowerCase()}}if(!String.prototype.toDate){String.prototype.toDate=function(e){var t=false;if(/^\d{1,2}\/\d{1,2}\/\d{1,4}$/.test(this)){t=this.split("/");var n=t[2],r=t[1]-1,i=t[0]}else if(/^\d{1,2}\-\d{1,2}\-\d{1,4}$/.test(this)){t=this.split("-");var n=t[2],r=t[0]-1,i=t[1]}if(t){var s=new Date(n,r,i);if(s&&s.getMonth()==Number(r)&&s.getDate()==Number(i))return s}return false}}var $cookies=new function(){this.get=function(e){var t=e+"=";var n=document.cookie.split(";");for(var r=0;r<n.length;r++){var i=n[r];while(i.charAt(0)==" ")i=i.substring(1,i.length);if(i.indexOf(t)==0)return i.substring(t.length,i.length)}return null};this.set=function(e,t,n){if(!n)n={};if(n.days==undefined)n.days=0;if(!isString(n.path))n.path="/";if(n.days){var r=new Date;r.setTime(r.getTime()+n.days*24*60*60*1e3);var i="; expires="+r.toGMTString()}else var i="";document.cookie=e+"="+t+i+"; path="+n.path};this["delete"]=function(e){createCookie(e,"",-1)}};(function(){window.imgCache=function(e,t){var n={};if(isArray(e)){e.forEach(function(e){console.log("caching: "+e);var t=document.createElement("img");t.src=e})}else if(isString(e)){if(n[e]){if(isFunction(t))t.apply(false)}else{var r=document.createElement("img");r.src=e;r.onload=t}}}})();window.B64={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",lookup:null,ie:/MSIE /.test(navigator.userAgent),ieo:/MSIE [67]/.test(navigator.userAgent),encode:function(e){var t=B64.toUtf8(e),n=-1,r=t.length,i,s,o,u=[,,,];if(B64.ie){var a=[];while(++n<r){i=t[n];s=t[++n];u[0]=i>>2;u[1]=(i&3)<<4|s>>4;if(isNaN(s))u[2]=u[3]=64;else{o=t[++n];u[2]=(s&15)<<2|o>>6;u[3]=isNaN(o)?64:o&63}a.push(B64.alphabet.charAt(u[0]),B64.alphabet.charAt(u[1]),B64.alphabet.charAt(u[2]),B64.alphabet.charAt(u[3]))}return a.join("")}else{var a="";while(++n<r){i=t[n];s=t[++n];u[0]=i>>2;u[1]=(i&3)<<4|s>>4;if(isNaN(s))u[2]=u[3]=64;else{o=t[++n];u[2]=(s&15)<<2|o>>6;u[3]=isNaN(o)?64:o&63}a+=B64.alphabet[u[0]]+B64.alphabet[u[1]]+B64.alphabet[u[2]]+B64.alphabet[u[3]]}return a}},decode:function(e){if(e.length%4)throw new Error("InvalidCharacterError: 'B64.decode' failed: The string to be decoded is not correctly encoded.");var t=B64.fromUtf8(e),n=0,r=t.length;if(B64.ieo){var i=[];while(n<r){if(t[n]<128)i.push(String.fromCharCode(t[n++]));else if(t[n]>191&&t[n]<224)i.push(String.fromCharCode((t[n++]&31)<<6|t[n++]&63));else i.push(String.fromCharCode((t[n++]&15)<<12|(t[n++]&63)<<6|t[n++]&63))}return i.join("")}else{var i="";while(n<r){if(t[n]<128)i+=String.fromCharCode(t[n++]);else if(t[n]>191&&t[n]<224)i+=String.fromCharCode((t[n++]&31)<<6|t[n++]&63);else i+=String.fromCharCode((t[n++]&15)<<12|(t[n++]&63)<<6|t[n++]&63)}return i}},toUtf8:function(e){var t=-1,n=e.length,r,i=[];if(/^[\x00-\x7f]*$/.test(e))while(++t<n)i.push(e.charCodeAt(t));else while(++t<n){r=e.charCodeAt(t);if(r<128)i.push(r);else if(r<2048)i.push(r>>6|192,r&63|128);else i.push(r>>12|224,r>>6&63|128,r&63|128)}return i},fromUtf8:function(e){var t=-1,n,r=[],i=[,,,];if(!B64.lookup){n=B64.alphabet.length;B64.lookup={};while(++t<n)B64.lookup[B64.alphabet.charAt(t)]=t;t=-1}n=e.length;while(++t<n){i[0]=B64.lookup[e.charAt(t)];i[1]=B64.lookup[e.charAt(++t)];r.push(i[0]<<2|i[1]>>4);i[2]=B64.lookup[e.charAt(++t)];if(i[2]==64)break;r.push((i[1]&15)<<4|i[2]>>2);i[3]=B64.lookup[e.charAt(++t)];if(i[3]==64)break;r.push((i[2]&3)<<6|i[3])}return r}};(function(){function e(){var e=0;var t=0;this.output="";this.readByte=function(n){if(typeof n=="string")n=n.charCodeAt(0);if(e<0){t|=n>>-e}else{t=n<<e&248}if(e>3){e-=8;return 1}if(e<4){this.output+=s[t>>3];e+=5}return 0};this.finish=function(n){var r=this.output+(e<0?s[t>>3]:"")+(n?"$":"");this.output="";return r}}function t(){var e=0;var t=0;this.output="";this.readChar=function(n){if(typeof n!="string"){if(typeof n=="number"){n=String.fromCharCode(n)}}n=n.toLowerCase();var r=u()[n];if(typeof r=="undefined"){return}r<<=3;t|=r>>>e;e+=5;if(e>=8){this.output+=String.fromCharCode(t);e-=8;if(e>0)t=r<<5-e&255;else t=0}};this.finish=function(t){var n=this.output+(e<0?s[bits>>3]:"")+(t?"$":"");this.output="";return n}}function n(t){var n=new e;var r=n.update(t,true);return r}function r(e){var n=new t;var r=n.update(e,true);return r}function i(e,t){if(typeof a=="undefined")a=require("crypto");var r=a.createHash("sha1");r.digest=function(e){return function(){return n(e.call(this,"binary"))}}(r.digest);if(t){if(typeof e=="string"||Buffer.isBuffer(e)){try{return t(null,i(e))}catch(s){return t(s,null)}}if(!typeof e.on=="function")return t({message:"Not a stream!"});e.on("data",function(e){r.update(e)});e.on("end",function(){t(null,r.digest())});return}if(e){return r.update(e).digest()}return r}var s="0123456789abcdefghjkmnpqrtuvwxyz";var o={o:0,i:1,l:1,s:5};var u=function(){var e={};for(var t=0;t<s.length;t++){e[s[t]]=t}for(var n in o){if(!o.hasOwnProperty(n))continue;e[n]=e[""+o[n]]}u=function(){return e};return e};e.prototype.update=function(e,t){for(var n=0;n<e.length;){n+=this.readByte(e[n])}var r=this.output;this.output="";if(t){r+=this.finish()}return r};t.prototype.update=function(e,t){for(var n=0;n<e.length;n++){this.readChar(e[n])}var r=this.output;this.output="";if(t){r+=this.finish()}return r};var a,f;i.file=function(e,t){if(e=="-"){process.stdin.resume();return i(process.stdin,t)}if(typeof f=="undefined")f=require("fs");return f.stat(e,function(n,r){if(n)return t(n,null);if(r.isDirectory())return t({dir:true,message:"Is a directory"});return i(require("fs").createReadStream(e),t)})};var l={Decoder:t,Encoder:e,encode:n,decode:r,sha1:i};if(typeof window!=="undefined"){window.B32=l}if(typeof module!=="undefined"&&module.exports){module.exports=l}})();var CryptoJS=CryptoJS||function(e,t){var n={},r=n.lib={},i=function(){},s=r.Base={extend:function(e){i.prototype=this;var t=new i;e&&t.mixIn(e);t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)});t.init.prototype=t;t.$super=this;return t},create:function(){var e=this.extend();e.init.apply(e,arguments);return e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=s.extend({init:function(e,n){e=this.words=e||[];this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||a).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes;e=e.sigBytes;this.clamp();if(r%4)for(var i=0;i<e;i++)t[r+i>>>2]|=(n[i>>>2]>>>24-8*(i%4)&255)<<24-8*((r+i)%4);else if(65535<n.length)for(i=0;i<e;i+=4)t[r+i>>>2]=n[i>>>2];else t.push.apply(t,n);this.sigBytes+=e;return this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-8*(n%4);t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);e.words=this.words.slice(0);return e},random:function(t){for(var n=[],r=0;r<t;r+=4)n.push(4294967296*e.random()|0);return new o.init(n,t)}}),u=n.enc={},a=u.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++){var i=t[r>>>2]>>>24-8*(r%4)&255;n.push((i>>>4).toString(16));n.push((i&15).toString(16))}return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-4*(r%8);return new o.init(n,t/2)}},f=u.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var n=[],r=0;r<e;r++)n.push(String.fromCharCode(t[r>>>2]>>>24-8*(r%4)&255));return n.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(e.charCodeAt(r)&255)<<24-8*(r%4);return new o.init(n,t)}},l=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(f.stringify(e)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(e){return f.parse(unescape(encodeURIComponent(e)))}},c=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init;this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=l.parse(e));this._data.concat(e);this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,r=n.words,i=n.sigBytes,s=this.blockSize,u=i/(4*s),u=t?e.ceil(u):e.max((u|0)-this._minBufferSize,0);t=u*s;i=e.min(4*t,i);if(t){for(var a=0;a<t;a+=s)this._doProcessBlock(r,a);a=r.splice(0,t);n.sigBytes-=i}return new o.init(a,i)},clone:function(){var e=s.clone.call(this);e._data=this._data.clone();return e},_minBufferSize:0});r.Hasher=c.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e);this.reset()},reset:function(){c.reset.call(this);this._doReset()},update:function(e){this._append(e);this._process();return this},finalize:function(e){e&&this._append(e);return this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return(new e.init(n)).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return(new h.HMAC.init(e,n)).finalize(t)}}});var h=n.algo={};return n}(Math);(function(e){var t=CryptoJS,n=t.lib,r=n.Base,i=n.WordArray,t=t.x64={};t.Word=r.extend({init:function(e,t){this.high=e;this.low=t}});t.WordArray=r.extend({init:function(t,n){t=this.words=t||[];this.sigBytes=n!=e?n:8*t.length},toX32:function(){for(var e=this.words,t=e.length,n=[],r=0;r<t;r++){var s=e[r];n.push(s.high);n.push(s.low)}return i.create(n,this.sigBytes)},clone:function(){for(var e=r.clone.call(this),t=e.words=this.words.slice(0),n=t.length,i=0;i<n;i++)t[i]=t[i].clone();return e}})})();(function(){function e(){return i.create.apply(i,arguments)}for(var t=CryptoJS,n=t.lib.Hasher,r=t.x64,i=r.Word,s=r.WordArray,r=t.algo,o=[e(1116352408,3609767458),e(1899447441,602891725),e(3049323471,3964484399),e(3921009573,2173295548),e(961987163,4081628472),e(1508970993,3053834265),e(2453635748,2937671579),e(2870763221,3664609560),e(3624381080,2734883394),e(310598401,1164996542),e(607225278,1323610764),e(1426881987,3590304994),e(1925078388,4068182383),e(2162078206,991336113),e(2614888103,633803317),e(3248222580,3479774868),e(3835390401,2666613458),e(4022224774,944711139),e(264347078,2341262773),e(604807628,2007800933),e(770255983,1495990901),e(1249150122,1856431235),e(1555081692,3175218132),e(1996064986,2198950837),e(2554220882,3999719339),e(2821834349,766784016),e(2952996808,2566594879),e(3210313671,3203337956),e(3336571891,1034457026),e(3584528711,2466948901),e(113926993,3758326383),e(338241895,168717936),e(666307205,1188179964),e(773529912,1546045734),e(1294757372,1522805485),e(1396182291,2643833823),e(1695183700,2343527390),e(1986661051,1014477480),e(2177026350,1206759142),e(2456956037,344077627),e(2730485921,1290863460),e(2820302411,3158454273),e(3259730800,3505952657),e(3345764771,106217008),e(3516065817,3606008344),e(3600352804,1432725776),e(4094571909,1467031594),e(275423344,851169720),e(430227734,3100823752),e(506948616,1363258195),e(659060556,3750685593),e(883997877,3785050280),e(958139571,3318307427),e(1322822218,3812723403),e(1537002063,2003034995),e(1747873779,3602036899),e(1955562222,1575990012),e(2024104815,1125592928),e(2227730452,2716904306),e(2361852424,442776044),e(2428436474,593698344),e(2756734187,3733110249),e(3204031479,2999351573),e(3329325298,3815920427),e(3391569614,3928383900),e(3515267271,566280711),e(3940187606,3454069534),e(4118630271,4000239992),e(116418474,1914138554),e(174292421,2731055270),e(289380356,3203993006),e(460393269,320620315),e(685471733,587496836),e(852142971,1086792851),e(1017036298,365543100),e(1126000580,2618297676),e(1288033470,3409855158),e(1501505948,4234509866),e(1607167915,987167468),e(1816402316,1246189591)],u=[],a=0;80>a;a++)u[a]=e();r=r.SHA512=n.extend({_doReset:function(){this._hash=new s.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],i=n[1],s=n[2],a=n[3],f=n[4],l=n[5],c=n[6],n=n[7],h=r.high,d=r.low,v=i.high,m=i.low,g=s.high,b=s.low,w=a.high,E=a.low,S=f.high,x=f.low,T=l.high,N=l.low,C=c.high,k=c.low,L=n.high,A=n.low,O=h,M=d,_=v,D=m,P=g,H=b,B=w,j=E,F=S,I=x,q=T,R=N,U=C,z=k,W=L,X=A,V=0;80>V;V++){var $=u[V];if(16>V)var J=$.high=e[t+2*V]|0,K=$.low=e[t+2*V+1]|0;else{var J=u[V-15],K=J.high,Q=J.low,J=(K>>>1|Q<<31)^(K>>>8|Q<<24)^K>>>7,Q=(Q>>>1|K<<31)^(Q>>>8|K<<24)^(Q>>>7|K<<25),G=u[V-2],K=G.high,Y=G.low,G=(K>>>19|Y<<13)^(K<<3|Y>>>29)^K>>>6,Y=(Y>>>19|K<<13)^(Y<<3|K>>>29)^(Y>>>6|K<<26),K=u[V-7],Z=K.high,et=u[V-16],tt=et.high,et=et.low,K=Q+K.low,J=J+Z+(K>>>0<Q>>>0?1:0),K=K+Y,J=J+G+(K>>>0<Y>>>0?1:0),K=K+et,J=J+tt+(K>>>0<et>>>0?1:0);$.high=J;$.low=K}var Z=F&q^~F&U,et=I&R^~I&z,$=O&_^O&P^_&P,nt=M&D^M&H^D&H,Q=(O>>>28|M<<4)^(O<<30|M>>>2)^(O<<25|M>>>7),G=(M>>>28|O<<4)^(M<<30|O>>>2)^(M<<25|O>>>7),Y=o[V],rt=Y.high,it=Y.low,Y=X+((I>>>14|F<<18)^(I>>>18|F<<14)^(I<<23|F>>>9)),tt=W+((F>>>14|I<<18)^(F>>>18|I<<14)^(F<<23|I>>>9))+(Y>>>0<X>>>0?1:0),Y=Y+et,tt=tt+Z+(Y>>>0<et>>>0?1:0),Y=Y+it,tt=tt+rt+(Y>>>0<it>>>0?1:0),Y=Y+K,tt=tt+J+(Y>>>0<K>>>0?1:0),K=G+nt,$=Q+$+(K>>>0<G>>>0?1:0),W=U,X=z,U=q,z=R,q=F,R=I,I=j+Y|0,F=B+tt+(I>>>0<j>>>0?1:0)|0,B=P,j=H,P=_,H=D,_=O,D=M,M=Y+K|0,O=tt+$+(M>>>0<Y>>>0?1:0)|0}d=r.low=d+M;r.high=h+O+(d>>>0<M>>>0?1:0);m=i.low=m+D;i.high=v+_+(m>>>0<D>>>0?1:0);b=s.low=b+H;s.high=g+P+(b>>>0<H>>>0?1:0);E=a.low=E+j;a.high=w+B+(E>>>0<j>>>0?1:0);x=f.low=x+I;f.high=S+F+(x>>>0<I>>>0?1:0);N=l.low=N+R;l.high=T+q+(N>>>0<R>>>0?1:0);k=c.low=k+z;c.high=C+U+(k>>>0<z>>>0?1:0);A=n.low=A+X;n.high=L+W+(A>>>0<X>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;t[r>>>5]|=128<<24-r%32;t[(r+128>>>10<<5)+30]=Math.floor(n/4294967296);t[(r+128>>>10<<5)+31]=n;e.sigBytes=4*t.length;this._process();return this._hash.toX32()},clone:function(){var e=n.clone.call(this);e._hash=this._hash.clone();return e},blockSize:32});t.SHA512=n._createHelper(r);t.HmacSHA512=n._createHmacHelper(r)})();(function(e){if(!e.fn.contains){e.fn.contains=function(t){if(isObject(t,"jquery")){var n=e(this);if(e(document).is(n))n=e(document.body);if(t.length==1){var r=false;while(t.parent().length){if(t.is(n))return true;t=t.parent()}}else if(t.length>1){var r=true;t.each(function(){if(!n.contains(e(this)))r=false});return r}}return false}}e.event.props.push("dataTransfer");e.fn.getKeys=function(t){var n=e(this);switch(n.prop("nodeName").toLowerCase()){case"table":n=n.find(">tbody>tr");break}if(t)n=n.filter(t);var r=n.length;if(r==0){return[]}else if(r==1){var i=false;if(n.data("keys")&&n.data("values")){var s=(""+n.data("keys")).split(",");var o=(""+n.data("values")).split(",");if(s.length&&s.length==o.length){i={};for(var u=0;u<s.length;u++){i[s[u]]=o[u]}}}if(!i){i={};switch(n.prop("nodeName").toLowerCase()){case"form":n.find("[name]").each(function(){var t=e(this);if(/^select|input|textarea$/i.test(t.prop("nodeName"))){var n=t.attr("name");if(!t.is(":disabled")){Object.key(i,n,t.val())}}});break;default:n.find("[data-key]").each(function(){var t=e(this);i[t.data("key")]=t.data("value")||this.textContent});break}}return i}else if(r>1){var a=[];n.each(function(){a.push(e(this).getKeys())});return a}else return false}})(jQuery);(function(e){e.fn.aniShow=function(t,n){var r=e(this),i={},s;if(!r.hasClass("animated"))r.addClass("animated");var o=r.attr("class");if(/t\-(\d+)s/.test(o)){var u=o.match(/t\-(\d+)s/);s=parseInt(u[1])*1e3}else if(/t\-(\d+)\_(\d)s/.test(o)){var u=o.match(/t\-(\d+)\_(\d)s/);s=parseInt(u[1])*1e3+parseInt(u[2])*100}else if(/t\-(\d+)\_(\d\d)s/.test(o)){var u=o.match(/t\-(\d+)\_(\d\d)s/);s=parseInt(u[1])*1e3+parseInt(u[2])*10}else s=500;if(isFunction(t))n=t;if(!isString(t)){n=t;t=r.attr("data-ani-show")||"fadeIn"}r.removeClass("hide").addClass(t);try{setTimeout(function(){r.removeClass(t);if(isFunction(n))n.apply(r.get(0))},s)}catch(a){r.removeClass(t);if(isFunction(n))n.apply(r.get(0))}return this};e.fn.aniHide=function(t,n){var r=e(this),i;if(!r.hasClass("animated"))r.addClass("animated");var s=r.attr("class");if(/t\-(\d+)s/.test(s)){var o=s.match(/t\-(\d+)s/);i=parseInt(o[1])*1e3}else if(/t\-(\d+)\_(\d)s/.test(s)){var o=s.match(/t\-(\d+)\_(\d)s/);i=parseInt(o[1])*1e3+parseInt(o[2])*100}else if(/t\-(\d+)\_(\d\d)s/.test(s)){var o=s.match(/t\-(\d+)\_(\d\d)s/);i=parseInt(o[1])*1e3+parseInt(o[2])*10}else i=500;if(isFunction(t))n=t;if(!isString(t)){n=t;t=r.attr("data-ani-hide")||"fadeOut"}r.addClass(t);try{setTimeout(function(){r.addClass("hide").removeClass(t);if(isFunction(n))n.apply(r.get(0))},i)}catch(u){r.addClass("hide").removeClass(t);if(isFunction(n))n.apply(r.get(0))}return this};e.fn.aniShake=function(){var t=e(this);t.addClass("animated t-0_5s shake");setTimeout(function(){t.removeClass("shake")},500);return this}})(jQuery);(function(e){function n(n,r){var i="";if(isString(n))i="?env="+n;else n="default";if(t[n])return t[n];e.ajax({type:"GET",url:"/-/model/i18n.json"+i,dataType:"text",global:false,async:isFunction(r),success:function(e){t[n]=JSON.parse(e);if(isFunction(r))r.apply(window.$i18n,[i18n[n]])}});if(isFunction(r))return true;else return t[n]||{}}var t={};window.$i18n=function(){var e=false,t=false;if(arguments.length){if(isString(arguments[0])){e=arguments[0];if(isFunction(arguments[1]))t=arguments[1]}else if(isFunction(arguments[0]))t=arguments[0];return n(e,t)}else return n(e)};window.$i18n.get=n;if(!String.i18n){String.prototype.i18n=function(){var e=this;return this.replace(/\$i18n{\s*([\:\w\-\_\.]+)\s*}/g,function(e,t){var r=t.split(":"),i=false,s,o;if(r[1]){i=r[0];s=r[1]}else{s=r[0]}o=n(i);return o[s]||e})}}window.i18n=function(e){if(isString(e))return/^[\:\w\-\_\.]+$/.test(e)?("$i18n{"+e+"}").i18n():e.i18n();else return e}})(jQuery);if(!Element.prototype.matchesSelector){Element.prototype.matchesSelector=Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector}if(!Element.prototype.val){Element.prototype.val=function(e){if(this.value===undefined)return false;if(e!==undefined){this.value=e;return this}else return this.value}}if(!HTMLSelectElement.prototype.val){HTMLSelectElement.prototype.val=function(e){if(e!==undefined){this.find("[value="+e+"]").attr("selected","selected");return this}else{return this.find("[selected=selected]").attr("value")}}}if(!HTMLFormElement.prototype.getKeys){HTMLFormElement.prototype.getKeys=function(){var e={};this.find("[name]").each(function(t){if(/^select|input|textarea$/i.test(t.nodeName)){var n=t.attr("name");if(!t.attr("disabled")){Object.key(e,n,t.val())}}});return e}}if(!Element.prototype.find)(function(){function e(e){var t=this;if(isString(e)){if(/\s/.test(e))[].push.apply(this,document.querySelectorAll(e));else{if(/^[a-zA-Z]+$/.test(e))[].push.apply(this,document.getElementsByTagName(e));else if(/^\#.+/.test(e))[].push.call(this,document.getElementById(e.substr(1)));else if(/^\..+/.test(e))[].push.apply(this,document.getElementsByClassName(e.substr(1)));else[].push.apply(this,document.querySelectorAll(e))}}else if(e instanceof Array)[].push.apply(this,e);else if(e instanceof NodeList)[].push.apply(this,e);else if(e instanceof HTMLCollection)[].push.apply(this,e);else if(e instanceof Element)[].push.call(this,e);else if(e===document)[].push.call(this,e)}e.prototype=new Array;e.fn=function(t,n,r){if(isString(t)){if(isFunction(n)){if(!Element.prototype[t])Element.prototype[t]=n}if(isFunction(r)){e.prototype[t]=r;NodeList.prototype[t]=r}}else if(isObject(t)&&arguments.length==1){Object.keys(t).forEach(function(n){e.fn(n,t[n].element,t[n].collection)})}};e.fn({get:{element:function(){return this},collection:function(e){return this[e]}},find:{element:function(t){return new e(Element.prototype.querySelectorAll.apply(this,arguments))},collection:function(t,n){var r=new e,i,s={};for(var o=0,u=this.length;o<u;o++){i=this[o].querySelectorAll(t);for(var a=0,f=i.length;a<f;a++){if(!i.item(a).__found){r.push(i.item(a));i.item(a).__found=true}}}for(var o=0,u=r.length;o<u;o++)delete r[o].__found;return r}},each:{element:function(e){if(isFunction(e))e.class(this,this);return this},collection:function(e){if(isFunction(e)){Array.prototype.forEach.call(this,e)}return this}},filter:{element:function(e){return Element.prototype.matchesSelector.call(this,e)?this:false},collection:function(t){var n=[];if(isFunction(t)){Array.prototype.forEach.call(this,function(e){if(t.apply(e,[e]))n.push(e)});return new e(n)}else if(isString(t)){Array.prototype.forEach.call(this,function(e){if(Element.prototype.matchesSelector.call(e,t))n.push(e)});return new e(n)}return this}},children:{element:false,collection:function(t,n){var r=[],i;if(document.body.children){r=new e;Array.prototype.forEach.call(this,function(e){[].push.apply(r,e.children)});if(t){if(isString(t)){r=r.filter(t)}else if(isFunction(t))r.each(t)}return r}else if(isString(t)){Array.prototype.forEach.call(this,function(e){e=e.firstElementChild||e.firstChild;while(e){if(e&&Element.prototype.matchesSelector.call(e,t))r.push(e);e=e.nextElementSibling}})}else if(isFunction(t)){Array.prototype.forEach.call(this,function(e){e=e.firstElementChild||e.firstChild;while(e){r.push(e);t.apply(e,n);e=e.nextElementSibling}})}else{Array.prototype.forEach.call(this,function(e){e=e.firstElementChild||e.firstChild;while(e){r.push(e);e=e.nextElementSibling}})}return new e(r)}},data:{element:function(e,t){if(isString(e)){if(isString(t)){if(this.getAttribute("data-"+e)!=null)this.setAttribute("data-"+e,t);else{if(this.dataset!==undefined)this.dataset[e]=t;else this.setAttribute("data-"+e,t)}return this}else return this.getAttribute("data-"+e)||(this.dataset?this.dataset[e]:false)}return this},collection:function(e,t){var n;if(isString(e)){if(!isString(t))return this[0].data(e);else{Array.prototype.forEach.call(this,function(n){n.data(e,t)});return this}}return this}},attr:{element:function(e,t){if(isString(e)){if(t!==undefined){this.setAttribute(e,t);return this}else return this.getAttribute(e)}return this},collection:function(e,t){var n;if(isString(e)){if(!isString(t))return this[0].getAttribute(e);else{Array.prototype.forEach.call(this,function(n){n.setAttribute(e,t)});return this}}return this}},addClass:{element:function(e){if(!this.className)this.className="";var t=new RegExp("\\b"+e+"\\b","");if(!t.test(this.className))this.className+=" "+e;return this},collection:function(e){Array.prototype.forEach.call(this,function(t){t.addClass(e)});return this}},removeClass:{element:function(e){if(this.className){var t=new RegExp("(\\b|\\s+)"+e+"\\b","g");this.className=this.className.replace(t,"")}return this},collection:function(e){Array.prototype.forEach.call(this,function(t){t.addClass(e)});return this}},hasClass:{element:function(e){if(!this.className)return false;patt=new RegExp("\\b"+e+"\\b","");return patt.test(this.className)},collection:function(e){var t=e.trim().split(" ");e="";t.forEach(function(t){e+="."+t});var n=this.filter(e);return n.length?n:false}},parent:{element:function(){if(this==document.body)return false;return this.parentElement||this.parentNode},collection:function(){var t=new e,n;Array.prototype.forEach.call(this,function(e){n=e.parent();if(n)t.push(n)});return t}},render:{element:function(e){this.innerHTML=e;return this},collection:function(e){Array.prototype.forEach.call(this,function(t){t.render(e)});return this}},on:{element:function(e,t){var n=this;if(isString(e)){if(isFunction(t)){var r=t;t=function(e){r.apply(e.target,[e].concat(e.data))};if(n.addEventListener){n.addEventListener(e,t,false)}else if(n.attachEvent){n.attachEvent("on"+e,t)}else throw"No es posible añadir evento";if(!n.listeners)n.listeners={};if(!n.listeners[e])n.listeners[e]=[];n.listeners[e].push(t)}else if(t===false){if(n.listeners){if(n.listeners[e]){var i=n.listeners[e];while(t=i.pop()){if(n.removeEventListener)n.removeEventListener(e,t,false);else if(n.detachEvent)n.detachEvent("on"+e,t)}}}}}return this},collection:function(e,t){Array.prototype.forEach.call(this,function(n){n.on(e,t)});return this}},off:{element:function(e){this.on(e,false)},collection:function(e){this.on(e,false)}},trigger:{element:function(e,t){triggerEvent(this,e,false,t)},collection:function(e,t){Array.prototype.forEach.call(this,function(n){triggerEvent(n,e,false,t)})}}});window.$dom=function(t){return new e(t)};document.find=function(e){return $dom(e)}})();(function(e){var t=function(e){return Element.prototype.find(e)};(function(){var n={};this.replaceKeys=function(e,t,n){if(!isString(e))return e;if(isObject(t))e=e.replaceKeys(t,n);if(isArray(t)){t.forEach(function(t){if(isObject(t)){e=e.replaceKeys(t,n)}})}return e};this.template=function(t,r){if(isString(r)){n[t]=r;if(isFunction(r.done))r.done.apply(null,[""]);return n[t]}else{if(isFunction(r))r={done:r,async:true};else if(!isObject(r))r={};if(n[t]){var i=$html.replaceKeys(n[t],r.replaceKeys,{clean:r.clearKeys}).i18n();if(isFunction(r.done))r.done.apply(null,[i]);return i}else{e.ajax({type:"GET",url:"/templates/"+t+".html",dataType:"text",global:false,async:!!r.async,success:function(e){s_tmpl=e.split(/<\/template>/);e="";s_tmpl.forEach(function(t){if(/<template\s+name="([\w\-\_\/]+)">/.test(t)){e+=t.replace(/([\w\W]*)<template\s+name="([\w\-\_\/]+)">([\w\W]*)/,function(e,t,r,i){n[r]=i;return t})}else e+=t});n[t]=e;if(isFunction(r.done))r.done.apply(null,[$html.replaceKeys(n[t],r.replaceKeys,{clean:r.clearKeys}).i18n()])}}).fail(function(e,t,n){if(isFunction(r.done))r.done.apply(null,['<div class="error">['+e.status+"] "+t+"</div>"])});if(!r.async){if(n[t])return $html.replaceKeys(n[t],r.replaceKeys,{clean:r.clearKeys}).i18n();else return'<div class="error">404</div>'}}}return""};this.jTemplate=function(n,r){return e(t.template(n,r))};this.templateLoaded=function(e){if(isString(e))return n[e]?true:false;return false};var r={};this.renderPlugin=function(e,t){if(isString(e)&&isFunction(t)){r[e]=t}};this.render_runPlugins=function(e,t){Object.keys(r).forEach(function(n){e.find(n).each(function(){r[n].apply(this,[t])})})};var i={};this.plugin=function(t,n){if(isString(t)&&isFunction(n)){i[t]=n;if($html.plugins_running){e(document.body).find(t).each(function(){n.apply(this,[])})}}};this.runPlugins=function(e,t){Object.keys(i).forEach(function(n){e.find(n).each(function(){i[n].apply(this,[t])})})}}).apply(t);e.fn.extractTemplates=function(){e(this).find("script[type='text/x-template'][name]").each(function(){var t=e(this);$html.template(t.attr("name"),t.text().trim());t.remove()});e(this).find("template[name]").each(function(){var t=e(this);$html.template(t.attr("name"),t.html());t.remove()})};e.fn.initDOM=function(n){var r=e(this);r.extractTemplates();r.find("template[name]").each(function(){var n=e(t.template(e(this).attr("name")));if(n)e(this).replaceWith(n)});r.find("form").on("submit",function(t){if(!this.checkValidity||this.checkValidity()){var n=e(this),r;function i(){n.find(".submitting-disable").attr("disabled","disabled");n.addClass("submitting");n.on("form.submit-end",function(e){n.removeClass("submitting");n.find(".submitting-disable").attr("disabled","disabled")});n.trigger("form.submit",[t])}if(r=n.attr("data-action-submit")){stopEvent(t);i();$doc.runAction("submit",r,n)}else if(n.data("ajax")){stopEvent(t);i()}}else e(this).trigger("form.invalid")});r.find("[autofocus]:last").focus();$html.render_runPlugins(r,n);$html.runPlugins(r,n)};e.fn.render=function(t,n){var r=e(this),i;if(!n)n={};t=$html.replaceKeys(t,n.replaceKeys);if(t!=undefined){r.html(t);r.initDOM(n);if(isFunction(n.done))n.done.apply(this)}return this};e.fn.renderHref=function(t,n){if(isFunction(n))n={done:n};else if(!n)n={};var r=this,i=e(this);i.addClass("loading");var s=(parseInt(i.data("version"))||0)+1;i.data("version",s);e.ajax(t,{headers:{"X-View":"HTMLHttpRequest"}}).done(function(e){if(parseInt(i.data("version"))==s){i.render(e,n)}}).always(function(){i.removeClass("loading")}).fail(function(e,t,r){if(parseInt(i.data("version"))==s){i.render("["+e.status+"] "+e.responseText,n)}});return this};e.fn.renderTemplate=function(t,n){if(arguments.length){var r=this;if(isFunction(n)){n={done:n,async:true}}else if(!isObject(n))n={};if(n.async||isFunction(n.done)){$html.template(t,{replaceKeys:n.replaceKeys,done:function(t){var i=n.done;n.done=false;if(n.model&&Mustache!=undefined){t=Mustache.render(t,n.model)}e(r).render(t,n);if(isFunction(i))i.apply(r)}})}else{var i=$html.template(t,{replaceKeys:n.replaceKeys});if(n.model&&Mustache!=undefined){i=Mustache.render(i,n.model)}e(r).render(i,n)}}return this};t.modal=function(n){if(!n)n={};else if(isString(n))n={tmpl:n};if(!e(document.body).children("modals").length){t.jModals=e("<modals>");e(document.body).append(t.jModals)}var r=e('<div class="modal-screen '+n.mode+'">');t.jModals.append(r);if(!e(document.body).hasClass("modals-active"))e(document.body).addClass("modals-active");var i=e('<div class="modal-bg '+(n.classBG||"bg-black-05")+' animated t-0_25s fadeIn">');r.append(i);var s=e('<div class="modal-wrapper animated t-0_25s fadeInDown" data-ani-hide="fadeOutUp">');r.append(s);var o=e('<div class="modal-box animated t-0_4s border-radius">');s.append(o);var u=e('<div class="modal-header bar-shadow"><button modal="close" type="button" class="button-close">&times;</div></div>');o.append(u);var a=e('<div class="modal-body">');o.append(a);o.reload=function(){if(n.url){a.renderHref(n.url,function(){if(isFunction(n.ready))n.ready.apply(o.get(0),[o])})}else if(n.template){if(!$html.templateLoaded(n.template)){}a.renderTemplate(n.template,{async:true,replaceKeys:n.replaceKeys||{},model:n.model,done:function(){if(isFunction(n.ready))n.ready.apply(o.get(0),[o])}})}else if(n.iframe){a.html('<iframe style="width: 100%; height: 100%;" src="'+n.iframe+'" frameborder="0"></iframe>')}};o.reload();r.on("modal.close",function(){s.aniHide();i.aniHide(function(){r.remove();if(!e("modals").children().length)e(document.body).removeClass("modals-active");delete a;delete u;delete o;delete s;delete i;delete this});if(isFunction(n.close))n.close.apply(o.get(0),[o])});r.on("click",function(t){var n=e(t.target),r;if(n.is(i)||n.is(s))o.trigger("modal.close");else if(r=n.attr("modal")){switch(r){case"close":o.trigger("modal.close");break}}});o.close=function(){o.trigger("modal.close")};return o};window.$html=t;e(document).ready(function(){e(document.body).initDOM();$html.plugins_running=true})})(jQuery);$(document).on("engine.ready",function(){$doc.click("[data-modal-href]",function(){var e=$(this);var t=$html.modal({url:e.attr("data-modal-href")})})});(function(e){var t=new function(){this._data=false;this.url="/-/model/user.json";this.on={};this.question=function(){return $cookies.get("question")||""};this.status=function(n){if(typeof n=="boolean"){async=!n;n=function(){}}else async=true;e.ajax(t.url,{type:"GET",async:async,contentType:"application/json",success:function(e){t._data=e;if(isFunction(n))n.apply(t)}})};this.data=function(){if(t._data)return t._data;t.status(true);return t._data};this.isLogged=function(){return t.data().logged};this.logIn=function(){var n;if(arguments.length==1){form=false;if(isFunction(arguments[0])){t.on.logIn=arguments[0];return true}else if(isObject(arguments[0],"any")){form=arguments[0];if(form.get)form=form.get(0);if(isObject(form,"htmlformelement")){n=form.getKeys();console.log("data: "+JSON.stringify(n))}else{form=false;n=arguments[0]}}else n=arguments[0]}else if(arguments.length==3){if(isFunction(arguments[2]))n={onSuccess:arguments[2]};else n=arguments[2];n.uname=arguments[0];n.upass=arguments[1]}var r=CryptoJS.SHA512(t.question()+CryptoJS.SHA512(n.upass||"").toString()).toString();var i={answer:r};if(n.uname)i.uname=n.uname;if(n.email)i.email=n.email;return $ajax.postJSON(t.url,{data:i}).done(function(r,i,s){t._data=r;if(isFunction(n.onSuccess))n.onSuccess.apply(t,[t._data]);if(isFunction(n.onAlways))n.onAlways.apply(t,[t._data]);if(isFunction(t.on.logIn))t.on.logIn.apply(t,[t._data]);e(document).trigger("user.logged-in");e(document).trigger("user.change")}).fail(function(r,i,s){if(isFunction(n.onError))n.onError.apply(t,[t._data]);if(isFunction(n.onAlways))n.onAlways.apply(t,[t._data]);e(document).trigger("user.logged-in-failed")}).always(function(){if(form)e(form).trigger("form.submit-end",[form])})};this.logOut=function(n){if(arguments.length==1){n=arguments[0];if(isFunction(n)){t.on.logOut=n;return true}}return e.ajax(t.url,{type:"DELETE",contentType:"application/json"}).done(function(r,i,s){t._data=r;try{n.onSuccess(t,[t._data])}catch(o){}try{t.on.logOut(t,[t._data])}catch(o){}this._data=false;e(document).trigger("user.logged-out");e(document).trigger("user.change")}).fail(function(e,r,i){try{n.onError(t,[t._data])}catch(s){}})}};e(document).on("user.logged-required",t.logOut);window.$user=t})(jQuery);(function(e){var t={},n=e("<event>"),r={"new":{},updated:{}},i={};modelHandler=function(e){this.name=e};modelHandler.prototype.on=function(e,t){var i=this;if(isString(e)){if(isFunction(t)){if(!isObject(r[e]))r[e]={};r[e][i.name]=t}else if(t==undefined)return n[e]||{};else if(isString(t)){if(isObject(n[e]))return n[e][t];else return false}}};n.on("new",function(t,n,r){var i=n.on("new",n.name);if(isFunction(i))actions.apply(_model(table),[r]);e(document).find("[model-name='"+n.name+"']").trigger("model.new",[r])});n.on("updated",function(t,n,r){var i=n.on("updated",n.name);if(isFunction(i))actions.apply(_model(table),[r]);e(document).find("[model-name='"+n.name+"']").trigger("model.updated",[r])});n.on("status",function(t,n,r){var i=n.on("status",n.name);if(isFunction(i))actions.apply(_model(table),[r]);e(document).find("[model-name='"+n.name+"']").trigger("model.status",[r])});modelHandler.prototype.status=function(e,t){var r=this;if(isString(e))e=Number(e);var i=r.table(),s=i.data[i.index[e]];if(s){if(isString(t)){s.status=t;n.trigger("updated",[r,s])}return s.status}return false};modelHandler.prototype.trigger=function(e,t){n.trigger(t,[model,this.get(e)])};var s=function(e,t,n){this.model=e;this.table=t;this.id=n};s.prototype.attr=function(e,t){if(isString(e)){var r=this.table.data[this.table.index[this.id]];if(t!=undefined){r[e]=t;n.trigger("updated",[this.model,r])}return r[e]}return false};s.prototype.is=function(e,t){if(isString(e)){var r=this.table.data[this.table.index[this.id]];if(r.$is==undefined)r.$is={};if(t!=undefined){r.$is[e]=t;n.trigger("updated",[this.model,r])}return r.$is[e]}return false};s.prototype.isnt=function(e){if(isString(e)){var t=this.table.data[this.table.index[this.id]];t.$is[e]=false;n.trigger("updated",[this.model,t]);return true}return false};modelHandler.prototype.clear=function(){t[this.name]=false};modelHandler.prototype.item=function(e){var n=t[this.name];return new s(this,n,e)};modelHandler.prototype.action=function(t,n){var r=this;if(isString(t)){if(!isObject(i[r.name]))i[r.name]={"delete":function(t){var n=r.status(t);r.status(t,"deleting");e.ajax({type:"DELETE",url:e(document.body).attr("data-model-url")?e(document.body).attr("data-model-url").replace(":user",r.name):"/data/"+r.name+".json",data:JSON.stringify({id:t,undo:n=="deleted"}),dataType:"json",contentType:"application/json"}).done(function(){r.status(t,n=="deleted"?"":"deleted")}).fail(function(n,i,s){if(n.status==401||n.status==403)e(document).trigger("user.logged-required",user.logOut);else r.status(t,"")})}};if(isFunction(n)){i[r.name][t]=n}else if(isFunction(i[r.name][t])){i[r.name][t].apply(r,n)}}};modelHandler.prototype.loadDependencies=function(e){if(isFunction(e))e={done:e};else if(!isObject(e))e={};var n=t[this.name],r=Object.keys(n.indexes);if(r.length){if(e.async){var i={};r.forEach(function(e){i[n.indexes[e]]=true})}r.forEach(function(t){var r=n.indexes[t];if(e.async){_model(r).table({async:true,done:function(){_model(r).loadDependencies({async:true,done:function(){delete i[r];if(!Object.keys(i).length)e.done.apply(n)}})}})}else if(_model(r).table()){if(!e.async)_model(r).loadDependencies()}})}else if(isFunction(e.done))e.done.apply(n)};modelHandler.prototype.updateList=function(){var e=t[this.name];e.list=[];Object.keys(e.index).forEach(function(t){e.list[e.index[t]]=parseInt(t)})};modelHandler.prototype.set=function(e){if(isObject(e)){t[this.name]=e;this.updateList()}};modelHandler.prototype.table=function(n){if(!n)n={};n.async=n.async==undefined?isFunction(n.done)?true:false:n.async;var r=this;var i=this.name;if(n.cache===false||!t[i]){e.ajax({type:"GET",url:e(document.body).attr("data-model-url")?e(document.body).attr("data-model-url").replace(":user",i):"/data/"+i+".json",async:n.async,dataType:"json",contentType:"application/json",success:function(e){r.set(e);if(n.async){console.log("loaded "+i+".json");if(n.cascade){r.loadDependencies({async:true,done:n.done})}else if(isFunction(n.done))n.done.apply(r,[t[i]])}}}).fail(function(t,n,r){if(t.status==401||t.status==403)e(document).trigger("user.logged-required",user.logOut)});if(!n.async)console.log("loaded "+i+".json")}else if(n.async){if(n.cascade){r.loadDependencies({async:true,done:n.done})}else if(isFunction(n.done))n.done.apply(r,[t[i]])}if(t[i]){if(n.cascade)r.loadDependencies({async:false});return t[i]}return false};modelHandler.prototype.parsedData=function(e,n){var r=this,i;if(isString(e))e=parseInt(e);if(!n)r.table({cascade:true});if(i=t[r.name]){if(isArray(e)){var s=[];e.forEach(function(e){s.push(r.parsedData(e,true))});return s}else if(isNumber(e)){var o=i.index[e];if(isNumber(o)){var u={},a=i.data[parseInt(o)];Object.keys(a).forEach(function(e){var t=i.indexes[e];if(t!=undefined){u[e]=_model(t).parsedData(a[e],true)}else u[e]=a[e]});return u}}else if(e==undefined)return r.parsedData(i.list,true)}return false};modelHandler.prototype._get=function(n,r){function o(){s=t[i.name];if(isNumber(r.pos))n=s.list[r.pos];else if(isArray(r.pos)){n=[];r.pos.forEach(function(e){n.push(s.list[e])})}else if(n==undefined)n=s.list}var i=this,s=t[i.name];r.async=r.async===undefined?isFunction(r.done)?true:false:r.async;if(r.mode=="full"){var u=true,a=e(document.body).attr("data-model-url")?e(document.body).attr("data-model-url").replace(":user",i.name):"/data/"+i.name+".json";e.ajax({type:"GET",url:a+"?mode=full",async:r.async,dataType:"json",contentType:"application/json",success:function(e){u=e;if(isFunction(r.done))r.done.apply(i,[e])}});return u}else if(r.async){i.table({done:function(){o();if(isFunction(r.done))r.done.apply(i,[i.parsedData(n)])},async:true});return true}else{i.table();o();if(isFunction(r.done))r.done.apply(i,[i.parsedData(n)]);return i.parsedData(n)}return false};modelHandler.prototype.get=function(){var e={},t=undefined;if(isString(arguments[0])){if(Number(arguments[0]))arguments[0]=Number(arguments[0])}if(isNumber(arguments[0])||isArray(arguments[0])){t=arguments[0];if(isFunction(arguments[1])){if(isObject(arguments[2])){e=arguments[2];e.done=arguments[1]}else if(isFunction(arguments[2])){if(isObject(arguments[3]))e=arguments[3];e.fail=arguments[2];e.done=arguments[1]}else e.done=arguments[1]}else if(isObject(arguments[1]))e=arguments[1]}else if(isFunction(arguments[0])){if(isFunction(arguments[1])){e={done:arguments[0]};e.fail=arguments[1]}else if(isObject(arguments[1])){e=arguments[1];e.done=arguments[0]}else e.done=arguments[0]}else if(isObject(arguments[0]))e=arguments[0];return this._get(t,e)};modelHandler.prototype.save=function(t,r){var i=this;if(isFunction(r))r={done:r};else if(!isObject(r))r={};var s=e.ajax({type:"POST",url:e(document.body).attr("data-model-url")?e(document.body).attr("data-model-url").replace(":user",i.name):"/data/"+i.name+".json",data:JSON.stringify(t),dataType:"json",contentType:"application/json",success:function(e){var s,o=i.table();if(s=parseInt(t.id)){var u=o.data[o.index[s]];Object.keys(e.data).forEach(function(t){u[t]=e.data[t]});console.log("status: "+u.status);n.trigger("updated",[i,u])}else{if(e.data){if(e.data.id){var a=o.length;o.data.push(e.data);o.index[parseInt(e.data.id)]=a;o.list.push(parseInt(e.data.id));n.trigger("new",[i,e.data])}}}if(isFunction(r.done))r.done.apply(i,[e])}}).fail(function(t,n,r){if(t.status==401||t.status==403)e(document).trigger("user.logged-required",user.logOut)});return s};_model=function(e,t){return new modelHandler(e,t)};_model.require=function(e,n){var r=this;if(!n)n={};else if(isFunction(n)){if(isObject(arguments[2])){arguments[2].done=n;n=arguments[2]}else n={done:n}}if(isString(e)&&/\w+,\w+/.test(e))e.split(",");if(isArray(e)){var i={};var s={};e.forEach(function(e){i[e]=true});e.forEach(function(e){_model.require(e,{done:function(t){delete i[e];s[e]=t;if(Object.keys(i).length==0){if(isFunction(n.done))n.done.apply(r,[s])}},async:n.async})})}else if(isString(e)){if(t[e]&&!n.reload){if(isFunction(n.done))n.done.apply(r,[t[e]]);return t[e]}else{if(n.reload)_model(e).clear();return _model(e).get(n.done)}}return false};_model.clear=function(){t={}};window.$model=_model;e(document).on("user.logged-out",function(){$model.clear();console.log("user.logged-out >: $model.clear();")})})(jQuery);$(function(){$html.renderPlugin("[model-repeat]",function(e){if(!e)e={};var t=$(this),n=t.parent(),r={};var i,s,o=t.attr("model-repeat");t.removeAttr("model-repeat");i=this.outerHTML;t.remove();cmd=o.split("|");if(s=cmd[0].match(/([\/\.\-\_\w]+)\sin\s([\/\-\_\.\w]+)/)){var u=s[2].split("."),a;var f=$model(u.shift());var l=s[1];f.get(function(e){if(t.attr("model-sortby"))e.sortBy(t.attr("model-sortby").split(","));e.forEach(function(e){if(e.status=="deleted")return false;var t=e;item_path=u.clone();while(a=item_path.shift()){if(t[a])t=t[a];else return false}var s={};s[l]=t;var o=$(i.replaceKeys(s,{clean:true}).i18n()).attr("model-item",f.name+"/"+t.id);r[t.id]=o;if(t.status!=undefined)o.attr("model-status",t.status);if(isObject(t.$is)){Object.keys(t.$is).forEach(function(e){if(t.$is[e])o.addClass("is-"+e)})}n.append(o)});n.attr("model-name",f.name);n.on("model.updated",function(e,t){var n=t;item_path=u.clone();while(a=item_path.shift()){if(n[a])n=n[a];else return false}var s={};s[l]=$model(f.name).get(n.id);jItem=$(i.replaceKeys(s,{clean:true}).i18n()).attr("model-item",f.name+"/"+n.id);if(n.status!=undefined)jItem.attr("model-status",n.status);if(isObject(n.$is)){Object.keys(n.$is).forEach(function(e){if(n.$is[e])jItem.addClass("is-"+e)})}r[n.id].replaceWith(jItem);r[n.id]=jItem});n.on("model.new",function(e,t){var s=t;item_path=u.clone();while(a=item_path.shift()){if(s[a])s=s[a];else return false}var o={};o[l]=$model(f.name).get(s.id);jItem=$(i.replaceKeys(o,{clean:true}).i18n()).attr("model-item",f.name+"/"+s.id);if(s.status!=undefined)jItem.attr("model-status",s.status);r[s.id]=jItem;n.prepend(jItem)});n.on("model.status",function(e,t){r[t.id].attr("model-status",t.status)})},{async:t.attr("model-async")?t.attr("model-async")=="true"?true:false:undefined})}});$(document).on("engine.ready",function(){$doc.click("[model-action]",function(){var e=$(this),t=e.attr("model-action"),n;var r=/^\s*(([\-\_\w]+)(\/([\-\_\w]+))?\.)?([\-\_\w]+)\s*$/;if(n=t.match(r)){var i=n[5],s=n[2],o=n[4];if(i){if(!s){if(e.attr("model-name"))s=e.attr("model-name");else if(e.attr("model-item")||e.data("model-item")){var u;if(u=(e.attr("model-item")||e.data("model-item")).match(/^\s*(.+)\/(.+)\s*$/)){if(u[1])s=u[1];if(u[2])o=u[2]}}else{var a=e;while(a.length){if(a.attr("model-item")||a.data("model-item")){var u;if(u=(a.attr("model-item")||a.data("model-item")).match(/^\s*(.+)\/(.+)\s*$/)){if(u[1])s=u[1];if(u[2])o=u[2]}}a=a.parent()}}}if(s)$model(s).action(i,[o])}}})})});(function($){var gears_list={},gear_definitions={};var gearHandler=function(e,t){this.name=e;if(isFunction(t))gear_definitions[this.name]=t};gearHandler.prototype.get=function(args){if(isFunction(args)){args={async:true,done:args}}else if(!isObject(args))args={};var gear_name=this.name;if(!gears_list[gear_name]){if(isFunction(gear_definitions[gear_name])){gears_list[gear_name]=new gear_definitions[gear_name];if(isFunction(args.done))args.done.apply(this,[gears_list[gear_name]])}else{$ajax("/gears/"+gear_name+".gear",{async:args.async===undefined?isFunction(args.done)?true:false:args.async}).done(function(data){var gear;try{eval("gear = new (function(){"+data+"})();")}catch(err){console.log("error parsing "+gear_name+".gear\n"+err.message);return false}gears_list[gear_name]=gear;if(isFunction(args.done))args.done.apply(this,[gear])}).fail(function(e){if(isFunction(args.done))args.done.apply(this,[false])})}}else{if(isFunction(args.done))args.done.apply(false,[gears_list[gear_name]])}return gears_list[gear_name]};gearHandler.prototype.run=function(){this.get(function(e){if(e){if(isFunction(e.run))e.run.apply(e)}else console.log("[warning] gear not foud: "+name)})};var gearsHandler=function(e,t){return new gearHandler(e,t)};window.$gear=gearsHandler})(jQuery);(function(e){e.plugin("[data-gear]",function(){$gear($(this).attr("data-gear")).run();console.log("[data-gear="+$(this).attr("data-gear")+"]")})})($html);(function(e){var t=new function(){var n=this;this.find=document.find;this.fn={};this.runFn=function(e){if(isFunction(n.fn[e]))n.fn[e]()};this.setFn=function(e,t){if(isString(e)&&isFunction(t))n.fn[e]=t};this.actions={};this.runAction=function(e,t,r,i){if(!i)i=[];if(isString(e)&&n.actions[e]){if(isFunction(n.actions[e][t]))n.actions[e][t].apply(r.get(0),i)}};this.action=function(e,t,r){if(isString(e)&&isString(t)&&isFunction(r)){if(!isObject(n.actions[e]))n.actions[e]={};n.actions[e][t]=r}};var r={};this.click=function(t,n){if(isString(t)){if(isFunction(n)){r[t]=n}else if(n==undefined){if(isFunction(r[t]))return r[t];else return function(){}}}else if(/^html[a-z]+element$/.test(varType(t))){Object.keys(r).forEach(function(i){if(isFunction(r[i])&&e(t).filter(i).length){r[i].apply(t,[n]);return true}})}else if(isObject(t,"jquery")){Object.keys(r).forEach(function(e){if(isFunction(r[e])&&t.filter(e).length){r[e].apply(t.get(0),[n]);return true}})}return false};this.on=function(t,n){e(document).on(t,n)};this.onhashchange={};this.onhashchange["default"]=function(){};this.hashChange=function(e){if(arguments.length){var t=arguments[0];if(/event/.test(varType(t))){n.onhashchange["default"].apply(t);if(n.onhashchange[n.view]){n.onhashchange[n.view].apply(t)}}else switch(varType(t)){case"function":n.onhashchange["default"]=t;break;case"string":var r;if(r=arguments[1]){if(isFunction(r))n.onhashchange[t]=r}break}}else{n.onhashchange["default"].apply(false);if(n.onhashchange[n.view]){n.onhashchange[n.view].apply(false)}}};this.onchangestate=function(){};this.changeState=function(t,r){if(arguments.length==1){if(isFunction(arguments[0]))n.onchangestate=arguments[0]}else if(isString(t)){if(!r)r={};if(isString(r.target_id)&&e(r.target_id)){e(r.target_id).addClass("loading");if(history.pushState){e("modals").children().trigger("modal.close");e.ajax({type:"GET",headers:{"X-View":"HTMLHttpRequest"},url:t,dataType:"text",processData:false}).always(function(n,i,s){if(i=="success"){var o={html:n,view_type:r.view_type,title:r.title||document.title||"",href:t,target_id:r.target_id}}else{if(Number(n.status)==403){r.view_type="user";e(document.body).attr("data-user-logged",false)}else r.view_type=n.status;var o={html:n.responseText,view_type:r.view_type,title:r.title||document.title||"",href:t,target_id:r.target_id}}history.pushState(o,document.title,t);e(r.target_id).removeClass("loading");try{var u=triggerEvent(document,"popstate",{state:o})}catch(a){alert(a.message)}})}}}};this.viewHandler={};this.onView=function(e,t){if(isString(e)){if(isFunction(t)){if(!isArray(n.viewHandler[e]))n.viewHandler[e]=[];n.viewHandler[e].push(t)}}};e(document).on("view.change",function(e){if(isArray(n.viewHandler[e.name])){n.viewHandler[e.name].forEach(function(t){if(isFunction(t))t.apply(e)})}});this.stateChange=function(r){if(isFunction(r))n.onchangestate=r;else{if(!n.current_pathname||n.current_pathname!=location.pathname){var i;if(i=r.state){n.view=location.pathname.split("/")[1];console.log("stateChange | html "+(i.html?"OK":"missing")+", target_id: "+i.target_id);if(i.target_id){if(i.html){e(i.target_id).render(i.html);e(document.body).attr("data-current-view",n.view);e(document.body).attr("data-view-type",i.view_type);if(/#/.test(i.href||""))t.hashChange();e(document).trigger("view.change",[{name:n.view,type:i.view_type}])}else e(i.target_id).renderHref(i.href,function(){e(document.body).attr("data-current-view",n.view);e(document.body).attr("data-view-type",i.view_type);if(/#/.test(i.href||""))t.hashChange();e(document).trigger("view.change",[{name:n.view,type:i.view_type}])})}n.onchangestate.call(i,r)}else{if(n.first_run)location.reload();n.first_run=true}}n.current_pathname=location.pathname}};n.view=location.pathname.split("/")[1]};t.ready=function(e){if(isFunction(e))e.apply()};window.$doc=t;window.onhashchange=$doc.hashChange;window.onpopstate=$doc.stateChange})(jQuery);$(document).ready(function(){var e=$(this);e.click(function(e){var t=$(e.target),n;if(e.which!=1)return false;while(t.length){if(n=t.attr("data-action-click"))$doc.runAction("click",n,t);if(n=t.attr("data-trigger")){if(n=="hashchange")$doc.hashChange();else t.trigger(n)}if(href=t.attr("href")){view_type=t.data("view")||(t.attr("target")?(t.attr("target").match(/^\s*view\:([\w\-\_]+)\s*/)||[])[1]:false);if(view_type){var r=t.attr("view-target")||"#main";if($(r).length&&history.pushState){stopEvent(e);if(href.split("#")[0]!=location.pathname.split("#")[0]){$doc.changeState(href,{view_type:view_type,target_id:r,element:t.get(0)})}else if(/#/.test(href)){location.hash=href.split("#")[1]}}break}if(target=t.attr("data-target")){if($(target).length){$(target).renderHref(href);stopEvent(e);break}}}if(className=t.attr("toggle-class")){if(t.hasClass(className))t.removeClass(className);else t.addClass(className)}if($doc.click(t,e))t=$();else t=t.parent()}});if(/#/.test(location))$doc.hashChange();$(document).trigger("engine.ready")});$html.plugin(".widget-slider",function(){function i(r){t=n.filter(".active");t.filter("[data-any-hide]").aniHide();t.removeClass("active").addClass("hidding");n.eq(r).addClass("active").aniShow(function(){t.removeClass("hidding")});var i=Number($(this).attr("data-slide-duration"))||Number(e.attr("data-slide-duration"));if(i)setTimeout(function(){o()},i)}function s(e,t){var n=e.find("img[data-on-demand]");if(!n.length&&isFunction(t))t.apply(e.get(0));else{var r=n.get(0);r.src=r.getAttribute("data-on-demand");r.removeAttribute("data-on-demand");r.onload=function(){t.apply(e.get(0))}}}function o(){var t=n.filter(".active").index()+1;if(t>=r)t=0;else if(t<0)t=r;var o=n.eq(t);if($(document).contains(e)){s(o,function(){i(t)})}}var e=$(this),t;var n=e.find(".slide");var r=n.length;n.addClass("hide");s(n.filter(":first"),function(){$(this).addClass("active").aniShow();var t=Number($(this).attr("data-slide-duration"))||Number(e.attr("data-slide-duration"));if(t)setTimeout(o,t)})});$doc.click("[data-active-list]",function(e){var t=$(this),n=$(e.target);var r=t.attr("data-active-list");while(n.length){if(t.is(n.parent())){if(r=="one"){if(!n.hasClass("active")){t.children().removeClass("active");n.addClass("active");t.trigger("change",[n,t])}}else{if(n.hasClass("active"))n.removeClass("active");else n.addClass("active");t.trigger("change",[t.children(".active"),t])}break}n=n.parent()}});$html.plugin("ul[data-select-name]",function(){var e=$(this),t=e.children("li"),n=t.children("a"),r=t.children("ul"),i=r.attr("data-active-list"),s=$('<input type="hidden" name="'+e.attr("data-select-name")+'"></input>'),o=r.children("[data-value]").not("[data-value=]"),u=r.children("[data-value=]");e.append(s);u.attr("data-text-label",n.text());r.on("change",function(t,n){t.stopPropagation();e.trigger("change",[n.attr("data-value")])});e.on("change",function(t,i){s.val(i);e.attr("data-selected-value",i);var o=r.children(".active");var u=o.attr("data-text-label")||o.text();n.text(u)});if(e.attr("data-filter-by")){var a=$("ul[data-select-name="+e.attr("data-filter-by")+"]");a.on("change",function(e,t){o.remove();if(t)r.append(o.filter("[data-filter="+t+"]"));else{var n={};a.find("[data-value]").each(function(){n[this.getAttribute("data-value")]=true});o.each(function(){if(n[this.getAttribute("data-filter")])r.append(this)})}if(r.children(".active").length)r.trigger("change",[r.children(".active")]);else{o.removeClass("active");jUl.trigger("change",[u.addClass("active")])}})}});$doc.click("label",function(e){$(this).next("input").focus();$(this).next("select").focus();$(this).next("textarea").focus()});$html.plugin("select[selected-value]",function(){var e=this.find("[value='"+this.attr("selected-value")+"']").each(function(e){e.selected=true})})